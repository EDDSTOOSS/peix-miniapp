<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Boutique</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial; background:#111; color:#fff; }
    .product {
      border:1px solid #333;
      padding:10px;
      margin:10px 0;
      border-radius:6px;
    }
    .price { color:#4caf50; }
  </style>
</head>
<body>

<h2>Produits disponibles</h2>
<div id="products"></div>

<script>
  const tg = window.Telegram.WebApp;

  // demander les produits au bot
  tg.sendData(JSON.stringify({
    action: "get_products"
  }));

  // recevoir la réponse du bot
  tg.onEvent("web_app_data_received", (event) => {
    const products = JSON.parse(event.data);
    const container = document.getElementById("products");
    container.innerHTML = "";

    if (products.length === 0) {
      container.innerHTML = "<p>Aucun produit disponible</p>";
      return;
    }

    products.forEach(p => {
      const div = document.createElement("div");
      div.className = "product";
      div.innerHTML = `
        <b>Prénom :</b> ${p.prenom}<br>
        <b>Âge :</b> ${p.age}<br>
        <b>Code postal :</b> ${p.code_postal}<br>
        <b>Code TE :</b> ${p.code_te}<br>
        <span class="price"><b>Prix :</b> ${p.price} €</span>
      `;
      container.appendChild(div);
    });
  });
</script>

</body>
</html>
